<% content_for :breadcrumb do %>
  <%= breadcrumbs ["Settings", settings_path], ["Facilities", all_settings_facility_facilities_path], "Rooms" %>
<% end %>

<%= render 'layouts/right_sidebar' %>

<div class="ph4 flex items-center pb3 pt3 bg-white ma4">
  <div class="w-70">
    <div class="dropdown">
      <a class="dropbtn link ba dib bw1 b b--light-gray gray pa2 ph3 br4">
        <%= params[:facility_id].present? ? blank(Facility.find(params[:facility_id]).name) : 'View by facility' %>
      </a>
      <div class="dropdown-content">
        <%= link_to "Show all", settings_facility_rooms_path, class: "dim pv3 ph3 bb b--light-gray f6 gray tc" %>
        <% Facility.all.each do |f| %>
          <%= link_to blank(f.name), settings_facility_rooms_path(facility_id: f.id), class: "dim pv3 ph3 bb b--light-gray blue f6 tc" %>
        <% end %>
      </div>
      
    </div>
    <div class="dropdown ml2">
      <a class="dropbtn link ba dib bw1 b b--light-gray  gray pa2 ph3 br4">
        <%= params[:filter].present? ? params[:filter] : 'Filter' %>
      </a>
      <div class="dropdown-content">
        <% ["Completed", "Incomplete"].each do |f| %>
          <%= link_to f, settings_facility_rooms_path(filter: f), class: "dim pv3 ph3 bb b--light-gray blue f6 tc" %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="bg-white mv3 mh4">
  <table class="w-100 table collapse">
    <thead>
      <tr>
        <th class="f6 dark-grey pv3 tl pl4 pr3">#</th>
        <th class="f6 dark-grey pv3 tl w-20">Name</th>
        <th class="f6 dark-grey pv3 tl w-10">Code</th>
        <th class="f6 dark-grey pv3 tl w-20">Description</th>
        <th class="f6 dark-grey pv3 tl ">Facility</th>
        <th class="f6 dark-grey pv3 tr pr3">Sections</th>
      </tr>
    </thead>

    <tbody>
      <% @rooms.each_with_index do |f, i| %>
        <tr data-toggle-right="<%= edit_settings_facility_room_path(f.id)%>" class="pointer striped--light-gray">
          <td class="f6 pv3 tl pl4 pr3 gray"><%= i+1 %></td>
          <td class="f6 tl"><%= blank(f.name) %></td>
          <td class="f6 tl"><%= blank(f.code) %></td>
          <td class="f6 tl">
            <p class="ma0 mb1"><%= f.desc %></p>
          </td>
          <td class="f6 tl "><%= f.facility.name %></td>
          <td class="f6 tr pr3 ">
            <%= f.sections.count %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>


